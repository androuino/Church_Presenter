<<<<<<< HEAD
const db=new Dexie("ServiceDB");db.version(1).stores({media:"id, link"}),m2d2.load(e=>{e.dict.set({yes:{en:"YES"},no:{en:"NO"},ok:{en:"OK"},send:{en:"SEND"},cancel:{en:"CANCEL"}})}),m2d2.ready(e=>{let t=!1,i=!1,o=!1,n="center",s="",a="",l=[],r=[],c=[];const f=e("main",{onready:function(t){e.get("/getthemes",t=>{t.ok&&(f.themeList.items.clear(),t.data.forEach(e=>{f.themeList.items.push({dataset:{id:e.id},text:e.themeName}),f.themeList2.items.push({dataset:{id:e.id},text:e.themeName})}),async function(){await db.media.get("videolink").then(e=>{e?h.value=e.link:console.log("media is empty")}),await db.media.get("settheme").then(e=>{e?(console.log("theme from db",e),Array.from(f.themeList.options).forEach(t=>{t.text===e.name&&(f.themeList.value=t.value,f.inputThemeName.value=e.name,A({theme:e.name}))})):console.log("No theme set.")}),await db.media.get("versions").then(t=>{t?(u.items.clear(),t.list.forEach(e=>{u.items.push({text:e})})):(console.log("No Bible versions saved."),e.get("/getbooks",e=>{e.ok&&(u.items.clear(),Object.entries(e.data).forEach(([e,t])=>{r.push(`${e} : ${t}`),u.items.push({text:`${e} : ${t}`})}),S("bibleversions",{list:r}))},e=>{console.error("Error getting books",e)},!0))}),await db.media.get("installed").then(t=>{t?(L.items.clear(),b.items.clear(),y.items.clear(),x.items.clear(),t.list.forEach(e=>{L.items.push({text:e}),b.items.push({text:e}),y.items.push({text:e}),x.items.push({text:e})})):(console.log("No Bible versions saved."),e.get("/getversions",e=>{e.ok&&(L.items.clear(),b.items.clear(),y.items.clear(),x.items.clear(),Object.entries(e.data).forEach(([e,t])=>{c.push(`${e} : ${t}`),L.items.push({text:`${e} : ${t}`}),b.items.push({text:`${e} : ${t}`}),y.items.push({text:`${e} : ${t}`}),x.items.push({text:`${e} : ${t}`})}),S("installedversions",{list:c}))}))})}())},!0)},navFontSettings:{onready:function(e){f.navFontSettings.classList.add("active")},onclick:function(e){f.settingFont.show=!0,f.navFontSettings.classList.add("active"),f.navLocationSettings.classList.remove("active"),f.navThemeList.classList.remove("active"),f.navBibleSettings.classList.remove("active")}},navLocationSettings:{onclick:function(e){f.settingLocation.show=!0,f.navLocationSettings.classList.add("active"),f.navFontSettings.classList.remove("active"),f.navThemeList.classList.remove("active"),f.navBibleSettings.classList.remove("active"),f.previewText.text=g.value}},navThemeList:{onclick:function(e){f.settingThemeList.show=!0,f.navThemeList.classList.add("active"),f.navFontSettings.classList.remove("active"),f.navLocationSettings.classList.remove("active"),f.navBibleSettings.classList.remove("active")}},navBibleSettings:{onclick:function(e){f.settingBible.show=!0,f.navBibleSettings.classList.add("active"),f.navFontSettings.classList.remove("active"),f.navLocationSettings.classList.remove("active"),f.navThemeList.classList.remove("active")}},settingFont:{show:!0,onshow:function(e){f.settingLocation.show=!1,f.settingThemeList.show=!1,f.settingBible.show=!1}},fontBold:{onclick:function(e){f.fontBold.classList.toggle("active"),fontBold.classList.contains("active")?(g.style.fontWeight="bold",f.previewText.style.fontWeight="bold",t=!0):(g.style.fontWeight="",f.previewText.style.fontWeight="",t=!1)}},fontItalic:{onclick:function(e){f.fontItalic.classList.toggle("active"),f.fontItalic.classList.contains("active")?(g.style.fontStyle="italic",f.previewText.style.fontStyle="italic",i=!0):(g.style.fontStyle="",f.previewText.style.fontStyle="",i=!1)}},fontStrikeThrough:{onclick:function(e){f.fontStrikeThrough.classList.toggle("active"),f.fontStrikeThrough.classList.contains("active")?(g.style.textDecoration="line-through",f.previewText.style.textDecoration="line-through",o=!0):(g.style.textDecoration="",f.previewText.style.textDecoration="",o=!1)}},settingLocation:{show:!1,onshow:function(e){f.settingFont.show=!1,f.settingThemeList.show=!1,f.settingBible.show=!1;window.location.hostname,window.location.protocol}},topLeftOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.topLeftOffset.value=t),f.previewText.style.marginTop=t+"px"}},topMiddleOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.topMiddleOffset.value=t),f.previewText.style.marginTop=t+"px"}},topRightOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.topRightOffset.value=t),f.previewText.style.marginTop=t+"px"}},leftUpperOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftUpperOffset.value=t),f.previewText.style.marginLeft=t+"px"}},radioTopLeft:{onclick:function(e){T("flex-start","flex-start"),k(),O(!1,!0,!0,!1,!0,!0,!0,!0,!0,!0,!0,!0)}},radioTopMiddle:{onclick:function(e){T("center","flex-start"),k(),O(!0,!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0)}},radioTopRight:{onclick:function(e){T("flex-end","flex-start"),k(),O(!0,!0,!1,!0,!1,!0,!0,!0,!0,!0,!0,!0)}},rightUpperOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightUpperOffset.value=t),f.previewText.style.marginRight=t+"px"}},leftMiddleOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftMiddleOffset.value=t),f.previewText.style.marginLeft=t+"px"}},radioLefMiddle:{onclick:function(e){T("flex-start","center"),k(),O(!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0)}},radioCenter:{onready:function(e){T("center","center"),O(!0,!1,!0,!0,!0,!1,!1,!0,!0,!0,!1,!0)},onclick:function(e){T("center","center"),k(),O(!0,!1,!0,!0,!0,!1,!1,!0,!0,!0,!1,!0)}},radioRightMiddle:{onclick:function(e){T("flex-end","center"),k(),O(!0,!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0)}},rightMiddleOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightMiddleOffset.value=t),f.previewText.style.marginRight=t+"px"}},leftLowerOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftLowerOffset.value=t),f.previewText.style.marginLeft=t+"px"}},radioLeftBottom:{onclick:function(e){T("flex-start","end"),k(),O(!0,!0,!0,!0,!0,!0,!0,!1,!0,!1,!0,!0)}},radioMiddleBottom:{onclick:function(e){T("center","end"),k(),O(!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!0)}},radioRightBottom:{onclick:function(e){T("flex-end","end"),k(),O(!0,!0,!0,!0,!0,!0,!0,!0,!1,!0,!0,!1)}},rightLowerOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightLowerOffset.value=t),f.previewText.style.marginRight=t+"px"}},leftBottomOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftBottomOffset.value=t),f.previewText.style.marginBottom=t+"px"}},middleBottomOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.middleBottomOffset.value=t),f.previewText.style.marginBottom=t+"px"}},rightBottomOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightBottomOffset.value=t),f.previewText.style.marginBottom=t+"px"}},fontAlignCenter:{onready:function(e){f.fontAlignCenter.classList.add("active"),f.previewText.style.textAlign="center"},onclick:function(e){f.previewText.style.textAlign="center",f.fontAlignCenter.classList.add("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="center"}},fontAlignHorRight:{onclick:function(e){f.previewText.style.textAlign="end",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.add("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="end"}},fontAlignJustify:{onclick:function(e){f.previewText.style.textAlign="justify",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.add("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="justify"}},fontAlignHorLeft:{onclick:function(e){f.previewText.style.textAlign="start",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.add("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="start"}},fontAlignRight:{onclick:function(e){f.previewText.style.textAlign="right",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.add("active"),f.fontAlignLeft.classList.remove("active"),n="right"}},fontAlignLeft:{onclick:function(e){f.previewText.style.textAlign="left",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.add("active"),n="left"}},buttonResetOffset:{onclick:function(e){f.previewText.style.margin="0",k()}},themeList:{template:{optionTheme:{tagName:"option",id:"optionTheme"}},items:[],onchange:function(e){const t={theme:e.target.value};f.inputThemeName.value=e.target.value,A(t)}},buttonSetTheme:{onclick:function(t){const i=f.themeList.value;if(""===i)e.failure("Please choose a theme");else{A({theme:i})}}},buttonOpenFile:{onclick:function(t){const i=[];e.upload(t,{field:"file",upload:"/upload",parallel:!0,maxFiles:30,maxSizeMb:5e3,onSelect:e=>{Array.from(e).forEach(e=>{i[0]={pct:0,file:e.name}})},onUpdate:(e,t,o)=>{i[o]={pct:e,file:t.name}},onResponse:e=>{console.log(e)},onDone:(e,t)=>{e.forEach(e=>{i[e.index]={pct:100,file:e.file.name}}),t&&console.log("all done")},onError:e=>{console.log(e),console.log("on error")}})}},buttonSetPlay:{onclick:function(t){if(""===h.value)e.failure("You did not provide a proper link.");else{S("media",{id:"videolink",link:h.value});const t={link:h.value};e.post("/bglink",t,e=>{e.ok&&console.debug("Setting bg with link success.")},e=>{console.error("Error setting background with provided link.",e)},!0)}}},buttonClearMedia:{onclick:function(t){e.post("/removebackground",e=>{e.ok&&""!=h.value&&(h.value="",db.media.delete("videolink"))})}},previewContainer:{},previewText:{},settingThemeList:{show:!1,onshow:function(e){f.settingFont.show=!1,f.settingLocation.show=!1,f.settingBible.show=!1}},themeList2:{template:{optionTheme2:{tagName:"option",id:"optionTheme2"}},items:[]},buttonDeleteTheme:{onclick:function(t){e.confirm("Confirm deleting this theme?",t=>{if(t)if("default"===f.themeList2.value)e.failure("Cannot delete default theme");else{const t=f.themeList2.options[f.themeList2.selectedIndex].dataset.id;console.log("selected id is",t),e.post("/deletetheme/"+t,t=>{t.ok&&e.success("Deleting theme success.")},t=>{e.failure("Error deleting a theme.",t)},!0)}})}},buttonDisableService:{onclick:function(t){e.confirm("Confirm to disable projector service?",t=>{t&&("Disable projector"===f.buttonDisableService.text?e.post("/disableservice",t=>{t.ok?(e.success("Success!"),f.buttonDisableService.text="Enable projector"):e.failure("Something's wrong disabling the service.")},e=>{console.error("Error disabling kiosk service.",e)},!0):e.post("/enableservice",t=>{t.ok?(e.success("Success!"),f.buttonDisableService.text="Disable projector"):e.failure("Something's wrong enabling the service.")},e=>{console.error("Error enabling kiosk service.",e)},!0))})}},settingBible:{show:!1,onshow:function(e){f.settingFont.show=!1,f.settingLocation.show=!1,f.settingThemeList.show=!1}},buttonInstall:{onclick:function(t){const i=u.value;""===i?e.failure("I didn't get that. Empty!"):e.confirm("Please confirm Bible version installation.",t=>{if(t){const t={initials:i.split(":")[0].trim()};e.post("/installbook",t,t=>{t.ok&&e.success("Installation is still in progress. Please refresh after 5 minutes.")},e=>{console.error("Error installing book",e)},!0)}})}},buttonUninstall:{onclick:function(t){const i=L.value;""===i?e.failure("I did not get that. Empty!"):e.confirm("Please confirm on uninstalling version?",t=>{if(t){const t={initials:i.split(":")[0].trim()};e.delete("/uninstallbook",t,t=>{t.ok&&e.success("Uninstall is still in progress. Please refresh after 5 minutes.")},e=>{console.error("Error uninstalling book",e)},!0)}})}},selectVersionsToProject:{onready:function(e){"1"===e.target.value&&(f.version1.enabled=!0,f.version2.enabled=!1,f.version3.enabled=!1)},onchange:function(e){"1"===e.target.value?(f.version1.show=!0,f.version2.show=!1,f.version3.show=!1):"2"===e.target.value?(f.version1.show=!0,f.version2.show=!0,f.version3.show=!1):"3"===e.target.value&&(f.version1.show=!0,f.version2.show=!0,f.version3.show=!0)}},version1:{},version2:{show:!1},version3:{show:!1},buttonSearch:{onclick:function(e){l=[],!0===f.version1.show&&l.push(b.value.split(":")[0].trim()),!0===f.version2.show&&l.push(y.value.split(":")[0].trim()),!0===f.version3.show&&l.push(x.value.split(":")[0].trim()),w(p.value,l)}},verseList:{template:{li:{tagName:"li",style:{border:"1px solid white",whiteSpace:"normal",cursor:"pointer"},preVerse:{tagName:"pre",css:"preVerse",style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},onclick:function(t){document.querySelectorAll("ul.verseList pre").forEach(e=>{e.style.backgroundColor="",e.style.color=""}),t.target.style.backgroundColor="lightgreen",t.target.style.color="black",l=[],!0===f.version1.show&&l.push(b.value.split(":")[0].trim()),!0===f.version2.show&&l.push(y.value.split(":")[0].trim()),!0===f.version3.show&&l.push(x.value.split(":")[0].trim());const i={verse:f.verseList.textContent,versions:l};e.post("/projectverse",i,e=>{e.ok&&console.debug("Success projecting verse")},e=>{console.error("Error projecting verse.",e)},!0)}}}},items:[]},inputThemeName:{},buttonSaveTheme:{onclick:function(o){if(""===f.inputThemeName.value)e.failure("Please type-in a theme's name");else{const o=f.themeList.options[f.themeList.selectedIndex].dataset.id;console.log("the id is",o);const l={id:o,themeName:f.inputThemeName.value.toLowerCase(),font:v.value,fontSize:d.value,fontColor:m.value,bold:t,italic:i,strikeThrough:i,topLeftOffset:f.topLeftOffset.value,topMiddleOffset:f.topMiddleOffset.value,topRightOffset:f.topRightOffset.value,leftUpperOffset:f.leftUpperOffset.value,rightUpperOffset:f.rightUpperOffset.value,leftMiddleOffset:f.leftMiddleOffset.value,rightMiddleOffset:f.rightMiddleOffset.value,leftLowerOffset:f.leftLowerOffset.value,rightLowerOffset:f.rightLowerOffset.value,leftBottomOffset:f.leftBottomOffset.value,middleBottomOffset:f.middleBottomOffset.value,rightBottomOffset:f.rightBottomOffset.value,textAlign:n,justifyContent:s,alignItems:a};e.put("/savetheme",l,t=>{t.ok?(console.log("data is",l),e.success("Theme saved.")):e.failure("An error occurred!")},t=>{e.failure("An error occurred!",t)},!0)}}}}),v=e("#selectFont",{template:{font:{tagName:"option",id:"font"}},items:[],onchange:function(e){g.style.fontFamily=v.value}}),d=e("#inputFontSize",{onready:function(e){this.value=24},onchange:function(e){var t=1;this.value<=0?this.value=1:(t=e.target.value,g.style.fontSize=t+"px",f.previewText.style.fontSize=t+"px")}});e("body",{onload:function(t){e.get("/getfonts",e=>{if(e.ok){var t="";v.items.clear(),e.data.forEach(e=>{("Arial"===e||"Ubuntu"===e||"San Francisco"===e)&&(t=e),v.items.push({text:e})}),v.items.length>0&&(v.value=t)}},!0)}});const g=e("#taFontPreview",{onchange:function(e){f.previewText.innerHTML=this.value.replace(/\n/g,"<br>")}}),m=e("#colorPicker",{onchange:function(e){const t=e.target.value;g.style.color=t,f.previewText.style.color=t,g.style.backgroundColor="#ffffff"===t||"white"===t?"black":""}});document.querySelectorAll('input[type="radio"]').forEach(e=>{e.addEventListener("click",e=>{document.querySelectorAll('input[type="radio"]').forEach(t=>{t!==e.target&&(t.checked=!1)})})});const h=e("#mediaLink"),p=e("#inputVerseSearch",{onkeydown:function(e){"Enter"===e.key&&(l=[],!0===f.version1.show&&l.push(b.value.split(":")[0].trim()),!0===f.version2.show&&l.push(y.value.split(":")[0].trim()),!0===f.version3.show&&l.push(x.value.split(":")[0].trim()),w(this.value,l))}}),u=e("#bibleVersions",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),L=e("#versionsInstalled",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),b=e("#selectVersion1",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),y=e("#selectVersion2",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),x=e("#selectVersion3",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]});function w(t,i){const o={verse:t,versions:i};e.post("/searchbibleverse",o,e=>{if(e.ok){const i=e.data;i.length>1&&"\n\n",f.verseList.items.clear();const o=i.length,n=Object.keys(i[0]).length;for(let e=0;e<n;e++){var t="";for(let n=0;n<o;n++){t=Object.keys(i[n])[e]}f.verseList.items.push({preVerse:{textContent:t}})}}},e=>{console.error("Error search verse:",e)},!0)}function k(){f.topLeftOffset.value=0,f.topMiddleOffset.value=0,f.topRightOffset.value=0,f.leftUpperOffset.value=0,f.rightUpperOffset.value=0,f.leftMiddleOffset.value=0,f.rightMiddleOffset.value=0,f.leftLowerOffset.value=0,f.rightLowerOffset.value=0,f.leftBottomOffset.value=0,f.middleBottomOffset.value=0,f.rightBottomOffset.value=0}function O(e,t,i,o,n,s,a,l,r,c,v,d){f.topLeftOffset.disabled=e,f.topMiddleOffset.disabled=t,f.topRightOffset.disabled=i,f.leftUpperOffset.disabled=o,f.rightUpperOffset.disabled=n,f.leftMiddleOffset.disabled=s,f.rightMiddleOffset.disabled=a,f.leftLowerOffset.disabled=l,f.rightLowerOffset.disabled=r,f.leftBottomOffset.disabled=c,f.middleBottomOffset.disabled=v,f.rightBottomOffset.disabled=d}function T(e,t){f.previewContainer.style.justifyContent=e,f.previewContainer.style.alignItems=t,s=e,a=t,console.log("justify content is ",e),console.log("align items is ",t)}function A(n){e.post("/settheme",n,e=>{if(e.ok){console.log("Theme is set to",e.data.theme_name),S("theme",{id:"settheme",theme:e.data.theme_name}),console.log("theme to set is",e.data);const a=e.data.font,l=e.data.font_size,r=e.data.font_color,c=e.data.bold,h=e.data.italic,p=e.data.strike_through,u=e.data.top_left_offset,L=e.data.top_middle_offset,b=e.data.top_right_offset,y=e.data.left_upper_offset,x=e.data.right_upper_offset,w=e.data.left_middle_offset,k=e.data.right_middle_offset,A=e.data.left_lower_offset,B=e.data.right_lower_offset,R=e.data.left_bottom_offset,M=e.data.middle_bottom_offset,_=e.data.right_bottom_offset,C=e.data.text_align,E=e.data.justify_content,N=e.data.align_items;f.topLeftOffset.value=u,f.leftUpperOffset.value=y,f.topMiddleOffset.value=L,f.topRightOffset.value=b,f.rightUpperOffset.value=x,f.leftMiddleOffset.value=w,f.rightMiddleOffset.value=k,f.leftLowerOffset.value=A,f.leftBottomOffset.value=R,f.middleBottomOffset.value=M,f.rightLowerOffset.value=B,f.rightBottomOffset.value=_;const F=u+L+b,j=R+M+_,U=y+w+A,D=x+k+B;switch(f.previewText.style.marginTop=F+"px",f.previewText.style.marginBottom=j+"px",f.previewText.style.marginLeft=U+"px",f.previewText.style.marginRight=D+"px",v.value=a,f.previewText.style.fontFamily=a,d.value=l,f.previewText.style.fontSize=l+"px",m.value=r,f.previewText.style.color=r,g.style.color=r,g.style.fontSize=l+"px",g.style.backgroundColor="#ffffff"===r||"white"===r?"black":"",c?(f.fontBold.classList.toggle("active"),f.previewText.style.fontWeight="bold",g.style.fontWeight="bold",t=!0):(f.fontBold.classList.remove("active"),f.previewText.style.fontWeight="",g.style.fontWeight=""),h?(f.fontItalic.classList.toggle("active"),f.previewText.style.fontStyle="italic",g.style.fontStyle="italic",i=!0):(f.fontItalic.classList.remove("active"),f.previewText.style.fontStyle="",g.style.fontStyle=""),p?(f.fontStrikeThrough.classList.toggle("active"),f.previewText.style.textDecoration="line-through",g.style.textDecoration="line-through",o=!0):(f.fontStrikeThrough.classList.remove("active"),f.previewText.style.textDecoration="",g.style.textDecoration=""),C){case"center":f.fontAlignCenter.classList.add("active"),f.previewText.style.textAlign="center";break;case"end":f.fontAlignHorRight.classList.add("active"),f.previewText.style.textAlign="end";break;case"justify":f.fontAlignJustify.classList.add("active"),f.previewText.style.textAlign="justify";break;case"start":f.fontAlignHorLeft.classList.add("active"),f.previewText.style.textAlign="start";break;case"right":f.fontAlignRight.classList.add("active"),f.previewText.style.textAlign="right";break;case"left":f.fontAlignLeft.classList.add("active"),f.previewText.style.textAlign="left";break;default:f.previewText.style.textAlign="center",console.error("Unknown text alignment")}T(E,N),s=N,"flex-start"===(n=E)&&"flex-start"===s?(f.radioTopLeft.checked=!0,O(!1,!0,!0,!1,!0,!0,!0,!0,!0,!0,!0,!0)):"center"===n&&"flex-start"===s?(f.radioTopMiddle.checked=!0,O(!0,!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0)):"flex-end"===n&&"flex-start"===s?(f.radioTopRight.checked=!0,O(!0,!0,!1,!0,!1,!0,!0,!0,!0,!0,!0,!0)):"flex-start"===n&&"center"===s?(f.radioLefMiddle.checked=!0,O(!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0)):"center"===n&&"center"===s?(f.radioCenter.checked=!0,O(!0,!1,!0,!0,!0,!1,!1,!0,!0,!0,!1,!0)):"flex-end"===n&&"center"===s?(f.radioRightMiddle.checked=!0,O(!0,!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0)):"flex-start"===n&&"end"===s?(f.radioLeftBottom.checked=!0,O(!0,!0,!0,!0,!0,!0,!0,!1,!0,!1,!0,!0)):"center"===n&&"end"===s?(f.radioMiddleBottom.checked=!0,O(!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!0)):"flex-end"===n&&"end"===s&&(f.radioRightBottom.checked=!0,O(!0,!0,!0,!0,!0,!0,!0,!0,!1,!0,!0,!1))}var n,s},!0)}async function S(e,t){switch(e){case"media":await db.media.put({id:t.id,link:t.link});break;case"theme":await db.media.put({id:t.id,name:t.theme});break;case"bibleversions":await db.media.put({id:"versions",list:t.list});break;case"installedversions":await db.media.put({id:"installed",list:t.list})}}tippy(".navFontSettings",{content:"Font settings (Font style and size)",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".navLocationSettings",{content:"Setting for the location of text on the screen",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".navThemeList",{content:"List of themes",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".navBibleSettings",{content:"Manage Bible versions",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".fontBold",{content:"Bold",interactive:!0,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontItalic",{content:"Italic",interactive:!0,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontStrikeThrough",{content:"Strike through",interactive:!0,placement:"bottom",animation:"scale",theme:"light"}),tippy(".topLeftOffset",{content:"Top-left offset",interactive:!1,placement:"top",animation:"scale",theme:"light"}),tippy(".topMiddleOffset",{content:"Top-middle offset",interactive:!1,placement:"top",animation:"scale",theme:"light"}),tippy(".topRightOffset",{content:"Top-right offset",interactive:!1,placement:"top",animation:"scale",theme:"light"}),tippy(".leftUpperOffset",{content:"Left-upper offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".rightUpperOffset",{content:"Right-upper offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".leftMiddleOffset",{content:"Left-middle offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".rightMiddleOffset",{content:"Right-middle offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".leftLowerOffset",{content:"Bottom-lower offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".rightLowerOffset",{content:"Right-lower offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".leftBottomOffset",{content:"Left-bottom offset",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".middleBottomOffset",{content:"Middle-bottom offset",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".rightBottomOffset",{content:"Right-bottom offset",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignCenter",{content:"Text align center",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignHorRight",{content:"Text align end",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignJustify",{content:"Text align justify",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignHorLeft",{content:"Text align start",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignRight",{content:"Text align right",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignLeft",{content:"Text align left",interactive:!1,placement:"bottom",animation:"scale",theme:"light"})});
=======
const db=new Dexie("ServiceDB");db.version(1).stores({media:"id, link"}),m2d2.load(e=>{e.dict.set({yes:{en:"YES"},no:{en:"NO"},ok:{en:"OK"},send:{en:"SEND"},cancel:{en:"CANCEL"}})}),m2d2.ready(e=>{let t=!1,i=!1,o=!1,n="center",s="",a="",l=[],r=[],c=[];const f=e("main",{onready:function(t){e.get("/getthemes",t=>{t.ok&&(f.themeList.items.clear(),t.data.forEach(e=>{f.themeList.items.push({dataset:{id:e.id},text:e.themeName}),f.themeList2.items.push({dataset:{id:e.id},text:e.themeName})}),async function(){await db.media.get("videolink").then(e=>{e?h.value=e.link:console.log("media is empty")}),await db.media.get("settheme").then(e=>{e?(console.log("theme from db",e),Array.from(f.themeList.options).forEach(t=>{t.text===e.name&&(f.themeList.value=t.value,f.inputThemeName.value=e.name,A({theme:e.name}))})):console.log("No theme set.")}),await db.media.get("versions").then(t=>{t?(u.items.clear(),t.list.forEach(e=>{u.items.push({text:e})})):(console.log("No Bible versions saved."),e.get("/getbooks",e=>{e.ok&&(u.items.clear(),Object.entries(e.data).forEach(([e,t])=>{r.push(`${e} : ${t}`),u.items.push({text:`${e} : ${t}`})}),S("bibleversions",{list:r}))},e=>{console.error("Error getting books",e)},!0))}),e.get("/getversions",e=>{e.ok&&(L.items.clear(),b.items.clear(),y.items.clear(),w.items.clear(),Object.entries(e.data).forEach(([e,t])=>{c.push(`${e} : ${t}`),L.items.push({text:`${e} : ${t}`}),b.items.push({text:`${e} : ${t}`}),y.items.push({text:`${e} : ${t}`}),w.items.push({text:`${e} : ${t}`})}),S("installedversions",{list:c}))})}())},!0)},navFontSettings:{onready:function(e){f.navFontSettings.classList.add("active")},onclick:function(e){f.settingFont.show=!0,f.navFontSettings.classList.add("active"),f.navLocationSettings.classList.remove("active"),f.navThemeList.classList.remove("active"),f.navBibleSettings.classList.remove("active")}},navLocationSettings:{onclick:function(e){f.settingLocation.show=!0,f.navLocationSettings.classList.add("active"),f.navFontSettings.classList.remove("active"),f.navThemeList.classList.remove("active"),f.navBibleSettings.classList.remove("active"),f.previewText.text=g.value}},navThemeList:{onclick:function(e){f.settingThemeList.show=!0,f.navThemeList.classList.add("active"),f.navFontSettings.classList.remove("active"),f.navLocationSettings.classList.remove("active"),f.navBibleSettings.classList.remove("active")}},navBibleSettings:{onclick:function(e){f.settingBible.show=!0,f.navBibleSettings.classList.add("active"),f.navFontSettings.classList.remove("active"),f.navLocationSettings.classList.remove("active"),f.navThemeList.classList.remove("active")}},settingFont:{show:!0,onshow:function(e){f.settingLocation.show=!1,f.settingThemeList.show=!1,f.settingBible.show=!1}},fontBold:{onclick:function(e){f.fontBold.classList.toggle("active"),fontBold.classList.contains("active")?(g.style.fontWeight="bold",f.previewText.style.fontWeight="bold",t=!0):(g.style.fontWeight="",f.previewText.style.fontWeight="",t=!1)}},fontItalic:{onclick:function(e){f.fontItalic.classList.toggle("active"),f.fontItalic.classList.contains("active")?(g.style.fontStyle="italic",f.previewText.style.fontStyle="italic",i=!0):(g.style.fontStyle="",f.previewText.style.fontStyle="",i=!1)}},fontStrikeThrough:{onclick:function(e){f.fontStrikeThrough.classList.toggle("active"),f.fontStrikeThrough.classList.contains("active")?(g.style.textDecoration="line-through",f.previewText.style.textDecoration="line-through",o=!0):(g.style.textDecoration="",f.previewText.style.textDecoration="",o=!1)}},settingLocation:{show:!1,onshow:function(e){f.settingFont.show=!1,f.settingThemeList.show=!1,f.settingBible.show=!1;window.location.hostname,window.location.protocol}},topLeftOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.topLeftOffset.value=t),f.previewText.style.marginTop=t+"px"}},topMiddleOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.topMiddleOffset.value=t),f.previewText.style.marginTop=t+"px"}},topRightOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.topRightOffset.value=t),f.previewText.style.marginTop=t+"px"}},leftUpperOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftUpperOffset.value=t),f.previewText.style.marginLeft=t+"px"}},radioTopLeft:{onclick:function(e){T("flex-start","flex-start"),k(),O(!1,!0,!0,!1,!0,!0,!0,!0,!0,!0,!0,!0)}},radioTopMiddle:{onclick:function(e){T("center","flex-start"),k(),O(!0,!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0)}},radioTopRight:{onclick:function(e){T("flex-end","flex-start"),k(),O(!0,!0,!1,!0,!1,!0,!0,!0,!0,!0,!0,!0)}},rightUpperOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightUpperOffset.value=t),f.previewText.style.marginRight=t+"px"}},leftMiddleOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftMiddleOffset.value=t),f.previewText.style.marginLeft=t+"px"}},radioLefMiddle:{onclick:function(e){T("flex-start","center"),k(),O(!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0)}},radioCenter:{onready:function(e){T("center","center"),O(!0,!1,!0,!0,!0,!1,!1,!0,!0,!0,!1,!0)},onclick:function(e){T("center","center"),k(),O(!0,!1,!0,!0,!0,!1,!1,!0,!0,!0,!1,!0)}},radioRightMiddle:{onclick:function(e){T("flex-end","center"),k(),O(!0,!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0)}},rightMiddleOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightMiddleOffset.value=t),f.previewText.style.marginRight=t+"px"}},leftLowerOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftLowerOffset.value=t),f.previewText.style.marginLeft=t+"px"}},radioLeftBottom:{onclick:function(e){T("flex-start","end"),k(),O(!0,!0,!0,!0,!0,!0,!0,!1,!0,!1,!0,!0)}},radioMiddleBottom:{onclick:function(e){T("center","end"),k(),O(!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!0)}},radioRightBottom:{onclick:function(e){T("flex-end","end"),k(),O(!0,!0,!0,!0,!0,!0,!0,!0,!1,!0,!0,!1)}},rightLowerOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightLowerOffset.value=t),f.previewText.style.marginRight=t+"px"}},leftBottomOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.leftBottomOffset.value=t),f.previewText.style.marginBottom=t+"px"}},middleBottomOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.middleBottomOffset.value=t),f.previewText.style.marginBottom=t+"px"}},rightBottomOffset:{disabled:!0,onchange:function(e){var t=e.target.value;t<=0&&(t=0,f.rightBottomOffset.value=t),f.previewText.style.marginBottom=t+"px"}},fontAlignCenter:{onready:function(e){f.fontAlignCenter.classList.add("active"),f.previewText.style.textAlign="center"},onclick:function(e){f.previewText.style.textAlign="center",f.fontAlignCenter.classList.add("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="center"}},fontAlignHorRight:{onclick:function(e){f.previewText.style.textAlign="end",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.add("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="end"}},fontAlignJustify:{onclick:function(e){f.previewText.style.textAlign="justify",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.add("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="justify"}},fontAlignHorLeft:{onclick:function(e){f.previewText.style.textAlign="start",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.add("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.remove("active"),n="start"}},fontAlignRight:{onclick:function(e){f.previewText.style.textAlign="right",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.add("active"),f.fontAlignLeft.classList.remove("active"),n="right"}},fontAlignLeft:{onclick:function(e){f.previewText.style.textAlign="left",f.fontAlignCenter.classList.remove("active"),f.fontAlignHorRight.classList.remove("active"),f.fontAlignJustify.classList.remove("active"),f.fontAlignHorLeft.classList.remove("active"),f.fontAlignRight.classList.remove("active"),f.fontAlignLeft.classList.add("active"),n="left"}},buttonResetOffset:{onclick:function(e){f.previewText.style.margin="0",k()}},themeList:{template:{optionTheme:{tagName:"option",id:"optionTheme"}},items:[],onchange:function(e){const t={theme:e.target.value};f.inputThemeName.value=e.target.value,A(t)}},buttonSetTheme:{onclick:function(t){const i=f.themeList.value;if(""===i)e.failure("Please choose a theme");else{A({theme:i})}}},buttonOpenFile:{onclick:function(t){const i=[];e.upload(t,{field:"file",upload:"/upload",parallel:!0,maxFiles:30,maxSizeMb:5e3,onSelect:e=>{Array.from(e).forEach(e=>{i[0]={pct:0,file:e.name}})},onUpdate:(e,t,o)=>{i[o]={pct:e,file:t.name}},onResponse:e=>{console.log(e)},onDone:(e,t)=>{e.forEach(e=>{i[e.index]={pct:100,file:e.file.name}}),t&&console.log("all done")},onError:e=>{console.log(e),console.log("on error")}})}},buttonSetPlay:{onclick:function(t){if(""===h.value)e.failure("You did not provide a proper link.");else{S("media",{id:"videolink",link:h.value});const t={link:h.value};e.post("/bglink",t,e=>{e.ok&&console.debug("Setting bg with link success.")},e=>{console.error("Error setting background with provided link.",e)},!0)}}},buttonClearMedia:{onclick:function(t){e.post("/removebackground",e=>{e.ok&&""!=h.value&&(h.value="",db.media.delete("videolink"))})}},previewContainer:{},previewText:{},settingThemeList:{show:!1,onshow:function(e){f.settingFont.show=!1,f.settingLocation.show=!1,f.settingBible.show=!1}},themeList2:{template:{optionTheme2:{tagName:"option",id:"optionTheme2"}},items:[]},buttonDeleteTheme:{onclick:function(t){e.confirm("Confirm deleting this theme?",t=>{if(t)if("default"===f.themeList2.value)e.failure("Cannot delete default theme");else{const t=f.themeList2.options[f.themeList2.selectedIndex].dataset.id;console.log("selected id is",t),e.post("/deletetheme/"+t,t=>{t.ok&&e.success("Deleting theme success.")},t=>{e.failure("Error deleting a theme.",t)},!0)}})}},buttonDisableService:{onclick:function(t){e.confirm("Confirm to disable projector service?",t=>{t&&("Disable projector"===f.buttonDisableService.text?e.post("/disableservice",t=>{t.ok?(e.success("Success!"),f.buttonDisableService.text="Enable projector"):e.failure("Something's wrong disabling the service.")},e=>{console.error("Error disabling kiosk service.",e)},!0):e.post("/enableservice",t=>{t.ok?(e.success("Success!"),f.buttonDisableService.text="Disable projector"):e.failure("Something's wrong enabling the service.")},e=>{console.error("Error enabling kiosk service.",e)},!0))})}},settingBible:{show:!1,onshow:function(e){f.settingFont.show=!1,f.settingLocation.show=!1,f.settingThemeList.show=!1}},buttonInstall:{onclick:function(t){const i=u.value;""===i?e.failure("I didn't get that. Empty!"):e.confirm("Please confirm Bible version installation.",t=>{if(t){const t={initials:i.split(":")[0].trim()};e.post("/installbook",t,t=>{t.ok&&e.success("New Bible version installed.")},e=>{console.error("Error installing book",e)},!0)}})}},buttonUninstall:{onclick:function(t){const i=L.value;""===i?e.failure("I did not get that. Empty!"):e.confirm("Please confirm on uninstalling version?",t=>{if(t){const t={initials:i.split(":")[0].trim()};e.delete("/uninstallbook",t,t=>{t.ok&&e.success("Uninstall is still in progress. Please refresh after 5 minutes.")},e=>{console.error("Error uninstalling book",e)},!0)}})}},selectVersionsToProject:{onready:function(e){"1"===e.target.value&&(f.version1.enabled=!0,f.version2.enabled=!1,f.version3.enabled=!1)},onchange:function(e){"1"===e.target.value?(f.version1.show=!0,f.version2.show=!1,f.version3.show=!1):"2"===e.target.value?(f.version1.show=!0,f.version2.show=!0,f.version3.show=!1):"3"===e.target.value&&(f.version1.show=!0,f.version2.show=!0,f.version3.show=!0)}},version1:{},version2:{show:!1},version3:{show:!1},buttonSearch:{onclick:function(e){l=[],!0===f.version1.show&&l.push(b.value.split(":")[0].trim()),!0===f.version2.show&&l.push(y.value.split(":")[0].trim()),!0===f.version3.show&&l.push(w.value.split(":")[0].trim()),x(p.value,l)}},verseList:{template:{li:{tagName:"li",style:{border:"1px solid white",whiteSpace:"normal",cursor:"pointer"},preVerse:{tagName:"pre",css:"preVerse",style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},onclick:function(t){document.querySelectorAll("ul.verseList pre").forEach(e=>{e.style.backgroundColor="",e.style.color=""}),t.target.style.backgroundColor="lightgreen",t.target.style.color="black",l=[],!0===f.version1.show&&l.push(b.value.split(":")[0].trim()),!0===f.version2.show&&l.push(y.value.split(":")[0].trim()),!0===f.version3.show&&l.push(w.value.split(":")[0].trim());const i={verse:f.verseList.textContent,versions:l};e.post("/projectverse",i,e=>{e.ok&&console.debug("Success projecting verse")},e=>{console.error("Error projecting verse.",e)},!0)}}}},items:[]},inputThemeName:{},buttonSaveTheme:{onclick:function(o){if(""===f.inputThemeName.value)e.failure("Please type-in a theme's name");else{const o=f.themeList.options[f.themeList.selectedIndex].dataset.id;console.log("the id is",o);const l={id:o,themeName:f.inputThemeName.value.toLowerCase(),font:v.value,fontSize:d.value,fontColor:m.value,bold:t,italic:i,strikeThrough:i,topLeftOffset:f.topLeftOffset.value,topMiddleOffset:f.topMiddleOffset.value,topRightOffset:f.topRightOffset.value,leftUpperOffset:f.leftUpperOffset.value,rightUpperOffset:f.rightUpperOffset.value,leftMiddleOffset:f.leftMiddleOffset.value,rightMiddleOffset:f.rightMiddleOffset.value,leftLowerOffset:f.leftLowerOffset.value,rightLowerOffset:f.rightLowerOffset.value,leftBottomOffset:f.leftBottomOffset.value,middleBottomOffset:f.middleBottomOffset.value,rightBottomOffset:f.rightBottomOffset.value,textAlign:n,justifyContent:s,alignItems:a};e.put("/savetheme",l,t=>{t.ok?(console.log("data is",l),e.success("Theme saved.")):e.failure("An error occurred!")},t=>{e.failure("An error occurred!",t)},!0)}}}}),v=e("#selectFont",{template:{font:{tagName:"option",id:"font"}},items:[],onchange:function(e){g.style.fontFamily=v.value}}),d=e("#inputFontSize",{onready:function(e){this.value=24},onchange:function(e){var t=1;this.value<=0?this.value=1:(t=e.target.value,g.style.fontSize=t+"px",f.previewText.style.fontSize=t+"px")}});e("body",{onload:function(t){e.get("/getfonts",e=>{if(e.ok){var t="";v.items.clear(),e.data.forEach(e=>{("Arial"===e||"Ubuntu"===e||"San Francisco"===e)&&(t=e),v.items.push({text:e})}),v.items.length>0&&(v.value=t)}},!0)}});const g=e("#taFontPreview",{onchange:function(e){f.previewText.innerHTML=this.value.replace(/\n/g,"<br>")}}),m=e("#colorPicker",{onchange:function(e){const t=e.target.value;g.style.color=t,f.previewText.style.color=t,g.style.backgroundColor="#ffffff"===t||"white"===t?"black":""}});document.querySelectorAll('input[type="radio"]').forEach(e=>{e.addEventListener("click",e=>{document.querySelectorAll('input[type="radio"]').forEach(t=>{t!==e.target&&(t.checked=!1)})})});const h=e("#mediaLink"),p=e("#inputVerseSearch",{onkeydown:function(e){"Enter"===e.key&&(l=[],!0===f.version1.show&&l.push(b.value.split(":")[0].trim()),!0===f.version2.show&&l.push(y.value.split(":")[0].trim()),!0===f.version3.show&&l.push(w.value.split(":")[0].trim()),x(this.value,l))}}),u=e("#bibleVersions",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),L=e("#versionsInstalled",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),b=e("#selectVersion1",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),y=e("#selectVersion2",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]}),w=e("#selectVersion3",{template:{option:{tagName:"option",style:{borderBottom:"1px solid black"}}},items:[]});function x(t,i){const o={verse:t,versions:i};e.post("/searchbibleverse",o,e=>{if(e.ok){const i=e.data;i.length>1&&"\n\n",f.verseList.items.clear();const o=i.length,n=Object.keys(i[0]).length;for(let e=0;e<n;e++){var t="";for(let n=0;n<o;n++){t=Object.keys(i[n])[e]}f.verseList.items.push({preVerse:{textContent:t}})}}},e=>{console.error("Error search verse:",e)},!0)}function k(){f.topLeftOffset.value=0,f.topMiddleOffset.value=0,f.topRightOffset.value=0,f.leftUpperOffset.value=0,f.rightUpperOffset.value=0,f.leftMiddleOffset.value=0,f.rightMiddleOffset.value=0,f.leftLowerOffset.value=0,f.rightLowerOffset.value=0,f.leftBottomOffset.value=0,f.middleBottomOffset.value=0,f.rightBottomOffset.value=0}function O(e,t,i,o,n,s,a,l,r,c,v,d){f.topLeftOffset.disabled=e,f.topMiddleOffset.disabled=t,f.topRightOffset.disabled=i,f.leftUpperOffset.disabled=o,f.rightUpperOffset.disabled=n,f.leftMiddleOffset.disabled=s,f.rightMiddleOffset.disabled=a,f.leftLowerOffset.disabled=l,f.rightLowerOffset.disabled=r,f.leftBottomOffset.disabled=c,f.middleBottomOffset.disabled=v,f.rightBottomOffset.disabled=d}function T(e,t){f.previewContainer.style.justifyContent=e,f.previewContainer.style.alignItems=t,s=e,a=t,console.log("justify content is ",e),console.log("align items is ",t)}function A(n){e.post("/settheme",n,e=>{if(e.ok){console.log("Theme is set to",e.data.theme_name),S("theme",{id:"settheme",theme:e.data.theme_name}),console.log("theme to set is",e.data);const a=e.data.font,l=e.data.font_size,r=e.data.font_color,c=e.data.bold,h=e.data.italic,p=e.data.strike_through,u=e.data.top_left_offset,L=e.data.top_middle_offset,b=e.data.top_right_offset,y=e.data.left_upper_offset,w=e.data.right_upper_offset,x=e.data.left_middle_offset,k=e.data.right_middle_offset,A=e.data.left_lower_offset,B=e.data.right_lower_offset,R=e.data.left_bottom_offset,M=e.data.middle_bottom_offset,_=e.data.right_bottom_offset,C=e.data.text_align,E=e.data.justify_content,N=e.data.align_items;f.topLeftOffset.value=u,f.leftUpperOffset.value=y,f.topMiddleOffset.value=L,f.topRightOffset.value=b,f.rightUpperOffset.value=w,f.leftMiddleOffset.value=x,f.rightMiddleOffset.value=k,f.leftLowerOffset.value=A,f.leftBottomOffset.value=R,f.middleBottomOffset.value=M,f.rightLowerOffset.value=B,f.rightBottomOffset.value=_;const F=u+L+b,j=R+M+_,U=y+x+A,D=w+k+B;switch(f.previewText.style.marginTop=F+"px",f.previewText.style.marginBottom=j+"px",f.previewText.style.marginLeft=U+"px",f.previewText.style.marginRight=D+"px",v.value=a,f.previewText.style.fontFamily=a,d.value=l,f.previewText.style.fontSize=l+"px",m.value=r,f.previewText.style.color=r,g.style.color=r,g.style.fontSize=l+"px",g.style.backgroundColor="#ffffff"===r||"white"===r?"black":"",c?(f.fontBold.classList.toggle("active"),f.previewText.style.fontWeight="bold",g.style.fontWeight="bold",t=!0):(f.fontBold.classList.remove("active"),f.previewText.style.fontWeight="",g.style.fontWeight=""),h?(f.fontItalic.classList.toggle("active"),f.previewText.style.fontStyle="italic",g.style.fontStyle="italic",i=!0):(f.fontItalic.classList.remove("active"),f.previewText.style.fontStyle="",g.style.fontStyle=""),p?(f.fontStrikeThrough.classList.toggle("active"),f.previewText.style.textDecoration="line-through",g.style.textDecoration="line-through",o=!0):(f.fontStrikeThrough.classList.remove("active"),f.previewText.style.textDecoration="",g.style.textDecoration=""),C){case"center":f.fontAlignCenter.classList.add("active"),f.previewText.style.textAlign="center";break;case"end":f.fontAlignHorRight.classList.add("active"),f.previewText.style.textAlign="end";break;case"justify":f.fontAlignJustify.classList.add("active"),f.previewText.style.textAlign="justify";break;case"start":f.fontAlignHorLeft.classList.add("active"),f.previewText.style.textAlign="start";break;case"right":f.fontAlignRight.classList.add("active"),f.previewText.style.textAlign="right";break;case"left":f.fontAlignLeft.classList.add("active"),f.previewText.style.textAlign="left";break;default:f.previewText.style.textAlign="center",console.error("Unknown text alignment")}T(E,N),s=N,"flex-start"===(n=E)&&"flex-start"===s?(f.radioTopLeft.checked=!0,O(!1,!0,!0,!1,!0,!0,!0,!0,!0,!0,!0,!0)):"center"===n&&"flex-start"===s?(f.radioTopMiddle.checked=!0,O(!0,!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0)):"flex-end"===n&&"flex-start"===s?(f.radioTopRight.checked=!0,O(!0,!0,!1,!0,!1,!0,!0,!0,!0,!0,!0,!0)):"flex-start"===n&&"center"===s?(f.radioLefMiddle.checked=!0,O(!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0)):"center"===n&&"center"===s?(f.radioCenter.checked=!0,O(!0,!1,!0,!0,!0,!1,!1,!0,!0,!0,!1,!0)):"flex-end"===n&&"center"===s?(f.radioRightMiddle.checked=!0,O(!0,!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0)):"flex-start"===n&&"end"===s?(f.radioLeftBottom.checked=!0,O(!0,!0,!0,!0,!0,!0,!0,!1,!0,!1,!0,!0)):"center"===n&&"end"===s?(f.radioMiddleBottom.checked=!0,O(!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!0)):"flex-end"===n&&"end"===s&&(f.radioRightBottom.checked=!0,O(!0,!0,!0,!0,!0,!0,!0,!0,!1,!0,!0,!1))}var n,s},!0)}async function S(e,t){switch(e){case"media":await db.media.put({id:t.id,link:t.link});break;case"theme":await db.media.put({id:t.id,name:t.theme});break;case"bibleversions":await db.media.put({id:"versions",list:t.list});break;case"installedversions":await db.media.put({id:"installed",list:t.list})}}tippy(".navFontSettings",{content:"Font settings (Font style and size)",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".navLocationSettings",{content:"Setting for the location of text on the screen",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".navThemeList",{content:"List of themes",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".navBibleSettings",{content:"Manage Bible versions",interactive:!0,placement:"right",animation:"scale",theme:"light"}),tippy(".fontBold",{content:"Bold",interactive:!0,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontItalic",{content:"Italic",interactive:!0,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontStrikeThrough",{content:"Strike through",interactive:!0,placement:"bottom",animation:"scale",theme:"light"}),tippy(".topLeftOffset",{content:"Top-left offset",interactive:!1,placement:"top",animation:"scale",theme:"light"}),tippy(".topMiddleOffset",{content:"Top-middle offset",interactive:!1,placement:"top",animation:"scale",theme:"light"}),tippy(".topRightOffset",{content:"Top-right offset",interactive:!1,placement:"top",animation:"scale",theme:"light"}),tippy(".leftUpperOffset",{content:"Left-upper offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".rightUpperOffset",{content:"Right-upper offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".leftMiddleOffset",{content:"Left-middle offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".rightMiddleOffset",{content:"Right-middle offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".leftLowerOffset",{content:"Bottom-lower offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".rightLowerOffset",{content:"Right-lower offset",interactive:!1,placement:"right",animation:"scale",theme:"light"}),tippy(".leftBottomOffset",{content:"Left-bottom offset",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".middleBottomOffset",{content:"Middle-bottom offset",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".rightBottomOffset",{content:"Right-bottom offset",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignCenter",{content:"Text align center",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignHorRight",{content:"Text align end",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignJustify",{content:"Text align justify",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignHorLeft",{content:"Text align start",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignRight",{content:"Text align right",interactive:!1,placement:"bottom",animation:"scale",theme:"light"}),tippy(".fontAlignLeft",{content:"Text align left",interactive:!1,placement:"bottom",animation:"scale",theme:"light"})});
>>>>>>> ktor
