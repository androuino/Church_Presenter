<<<<<<< HEAD
m2d2.load(e=>{e.dict.set({yes:{en:"YES"},no:{en:"NO"},ok:{en:"OK"},send:{en:"SEND"},cancel:{en:"CANCEL"}})}),m2d2.ready(e=>{const t=e("#splashScreen"),n=e("#main"),o=e("#lyrics"),i=e("#mediaContainer"),s=e("#info",{show:!1}),l=new EventSource("/events");e("body",{onload:function(o){setTimeout(function(){t.style.display="none",n.style.display="flex",s.show=!0,r("assets/tiny.mp4"),e.get("/getip",e=>{console.log(e),e.ok&&"connected"===e.data.status&&(s.textContent=e.data.ip)},e=>{console.error("Error getting ip.",e)},!0)},3e3)}});function r(e){i.innerHTML="";const t=e.startsWith("http://")||e.startsWith("https://")||e.startsWith("www."),n=t?function(e){if(e.includes("youtube.com")||e.includes("youtu.be")){let t="";return t=e.includes("youtu.be")?e.split("/").pop().split("?")[0]:new URL(e).searchParams.get("v"),t?`https://www.youtube.com/embed/${t}?autoplay=1&mute=1&controls=0&modestbranding=1&rel=0&loop=1&playlist=${t}`:null}if(e.includes("vimeo.com")){return`https://player.vimeo.com/video/${e.split("/").pop().split("?")[0]}?autoplay=1&muted=1&loop=1&title=0&byline=0&portrait=0`}if(e.includes("dailymotion.com")){return`https://www.dailymotion.com/embed/video/${e.split("/").pop().split("_")[0]}?autoplay=1&mute=1&controls=0`}return null}(e):null;if(n)i.innerHTML=`\n                <iframe\n                    width="100%"\n                    height="100%"\n                    src="${n}"\n                    frameborder="0"\n                    allow="autoplay; encrypted-media"\n                    allowfullscreen>\n                </iframe>\n            `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")||t&&(e.includes(".mp4")||e.includes(".webm")||e.includes(".ogg"))){let n="";e.endsWith(".mp4")||t&&e.includes(".mp4")?n="video/mp4":e.endsWith(".webm")||t&&e.includes(".webm")?n="video/webm":(e.endsWith(".ogg")||t&&e.includes(".ogg"))&&(n="video/ogg"),i.innerHTML=`\n                <video id="player" style="object-fit: cover; width:100%; height:100%;" autoplay muted loop playsinline>\n                    <source src="${e}" type="${n}" />\n                    Your browser does not support the video tag.\n                </video>\n            `;const o=document.getElementById("player");if(o){new Plyr(o)}}else e.endsWith(".jpeg")||e.endsWith(".jpg")||e.endsWith(".png")||t&&(e.includes(".jpeg")||e.includes(".jpg")||e.includes(".png"))?i.innerHTML=`\n                <img id="imgContainer" style="object-fit: cover; width:100%; height:100%;" src="${e}" alt="Image"/>\n            `:i.innerHTML="Unsupported media format."}l.addEventListener("lyrics",function(e){let t=e.data.split("\\n");t.shift();const n=t.join("\n").replace(/\\n/g,"\n").replace(/\$[a-zA-Z]/,"").replaceAll('"',"");o.textContent=n}),l.addEventListener("settings",function(e){}),l.addEventListener("clear",function(e){console.log("clear received."),o.textContent="",s.textContent="HWVCI Presenter"}),l.addEventListener("theme",function(e){var t=JSON.parse(JSON.parse(e.data));t.id;const i=t.font,s=t.font_size,l=t.font_color,r=t.bold,d=t.italic,a=t.strike_through,c=t.top_left_offset,p=t.top_middle_offset,f=t.top_right_offset,u=t.left_upper_offset,g=t.right_upper_offset,m=t.left_middle_offset,h=t.right_middle_offset,y=t.left_lower_offset,v=t.right_lower_offset,w=t.left_bottom_offset,_=t.middle_bottom_offset,b=t.right_bottom_offset,L=(t.text_align,t.justify_content,t.align_items,c+p+f),E=w+_+b,x=u+m+y,k=g+h+v;o.style.marginTop=L+"px",o.style.marginBottom=E+"px",o.style.marginLeft=x+"px",o.style.marginRight=k+"px",o.style.fontFamily=i,o.style.fontSize=s+"px",o.style.color=l,r&&(o.style.fontWeight="bold"),d&&(o.style.fontStyle="italic"),a&&(o.style.textDecoration="line-through"),o.style.textAlign=t.text_align,n.style.justifyContent=t.justify_content,n.style.alignItems=t.align_items}),l.addEventListener("verse",function(t){var n=JSON.parse(JSON.parse(t.data));e.post("/searchbibleverse",n,e=>{if(e.ok){var t="",n="";const l=e.data;l.length>1&&(t="\n\n");const r=l.length,d=Object.keys(l[0]).length;for(let e=0;e<d;e++){var i="";for(let n=0;n<r;n++)i+=l[n][Object.keys(l[n])[e]]+t;for(let t=0;t<r;t++){n=Object.keys(l[t])[e]}}o.textContent=i,s.textContent=n}},e=>{console.error("Error getting verse",e)},!0)}),l.addEventListener("media",function(e){}),l.addEventListener("hidelyrics",function(e){o.show=!1}),l.addEventListener("blackscreen",function(e){o.show=!1,i.innerHTML="",s.show=!1}),l.addEventListener("showdesktop",function(e){}),l.addEventListener("showlyrics",function(e){o.show=!0,s.show=!0}),l.addEventListener("removebackground",function(e){i.innerHTML=""}),l.addEventListener("title",function(e){s.textContent=e.data.replaceAll('"',"")}),l.addEventListener("changebackground",function(t){const n=t.data.replaceAll('"',"");if("link"===n)e.get("/getlink",e=>{e.ok?(console.log(e.link),r(e.link)):console.log("Failed to get link")},e=>{console.error("Error get bg link",e)},!0);else{r("uploaded/"+n)}}),l.addEventListener("connected",function(e){"true"===e.data.replaceAll('"',"")&&(s.textContent="info")}),l.addEventListener("apmode",function(e){const t=e.data.replaceAll('"',"");s.textContent=t})});
=======
m2d2.load(e=>{e.dict.set({yes:{en:"YES"},no:{en:"NO"},ok:{en:"OK"},send:{en:"SEND"},cancel:{en:"CANCEL"}})}),m2d2.ready(e=>{const t=e("#splashScreen"),n=e("#main"),o=e("#lyrics"),i=e("#mediaContainer"),s=e("#info",{show:!1}),l=new EventSource("/events");e("body",{onload:function(o){setTimeout(function(){t.style.display="none",n.style.display="flex",s.show=!0,r("assets/tiny.mp4"),e.get("/getip",e=>{console.log(e),e.ok&&"connected"===e.data.status&&(s.textContent=e.data.ip)},e=>{console.error("Error getting ip.",e)},!0)},3e3)}});function r(e){i.innerHTML="";const t=e.startsWith("http://")||e.startsWith("https://")||e.startsWith("www."),n=t?function(e){if(e.includes("youtube.com")||e.includes("youtu.be")){let t="";return t=e.includes("youtu.be")?e.split("/").pop().split("?")[0]:new URL(e).searchParams.get("v"),t?`https://www.youtube.com/embed/${t}?autoplay=1&mute=1&controls=0&modestbranding=1&rel=0&loop=1&playlist=${t}`:null}if(e.includes("vimeo.com")){return`https://player.vimeo.com/video/${e.split("/").pop().split("?")[0]}?autoplay=1&muted=1&loop=1&title=0&byline=0&portrait=0`}if(e.includes("dailymotion.com")){return`https://www.dailymotion.com/embed/video/${e.split("/").pop().split("_")[0]}?autoplay=1&mute=1&controls=0`}return null}(e):null;if(n)console.log("Media is a link"),i.innerHTML=`\n                <iframe\n                    width="100%"\n                    height="100%"\n                    src="${n}"\n                    frameborder="0"\n                    allow="autoplay; encrypted-media"\n                    allowfullscreen>\n                </iframe>\n            `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")||t&&(e.includes(".mp4")||e.includes(".webm")||e.includes(".ogg"))){console.log("Media is a video",e);let n="";e.endsWith(".mp4")||t&&e.includes(".mp4")?n="video/mp4":e.endsWith(".webm")||t&&e.includes(".webm")?n="video/webm":(e.endsWith(".ogg")||t&&e.includes(".ogg"))&&(n="video/ogg"),i.innerHTML=`\n                <video id="player" style="object-fit: cover; width:100%; height:100%;" autoplay muted loop playsinline>\n                    <source src="${e}" type="${n}" />\n                    Your browser does not support the video tag.\n                </video>\n            `;const o=document.getElementById("player");if(o){new Plyr(o)}}else e.endsWith(".jpeg")||e.endsWith(".jpg")||e.endsWith(".png")||t&&(e.includes(".jpeg")||e.includes(".jpg")||e.includes(".png"))?(console.log("Media is an image",e),i.innerHTML=`\n                <img id="imgContainer" style="object-fit: cover; width:100%; height:100%;" src="${e}" alt="Image"/>\n            `):(console.log("Unsupported media."),i.innerHTML="Unsupported media format.")}l.addEventListener("lyrics",function(e){try{const t=JSON.parse(e.data).data.split(/\r?\n/);t.length>0&&/^\$[a-zA-Z]/.test(t[0])&&t.shift();const n=t.join("\n");o.textContent=n,console.log("Cleaned lyrics:",n)}catch(t){console.error("Failed to parse lyrics event:",t,e.data)}}),l.addEventListener("settings",function(e){}),l.addEventListener("clear",function(e){console.log("clear received."),o.textContent="",s.textContent="HWVCI Presenter"}),l.addEventListener("theme",function(e){var t=JSON.parse(e.data);let i;i="application/json"===t.type?JSON.parse(t.data):t;i.id;const s=i.font,l=i.font_size,r=i.font_color,a=i.bold,d=i.italic,c=i.strike_through,p=i.top_left_offset,f=i.top_middle_offset,u=i.top_right_offset,g=i.left_upper_offset,m=i.right_upper_offset,y=i.left_middle_offset,h=i.right_middle_offset,v=i.left_lower_offset,w=i.right_lower_offset,_=i.left_bottom_offset,b=i.middle_bottom_offset,L=i.right_bottom_offset,E=(i.text_align,i.justify_content,i.align_items,p+f+u),k=_+b+L,x=g+y+v,C=m+h+w;o.style.marginTop=E+"px",o.style.marginBottom=k+"px",o.style.marginLeft=x+"px",o.style.marginRight=C+"px",o.style.fontFamily=s,o.style.fontSize=l+"px",o.style.color=r,a&&(o.style.fontWeight="bold"),d&&(o.style.fontStyle="italic"),c&&(o.style.textDecoration="line-through"),o.style.textAlign=i.text_align,n.style.justifyContent=i.justify_content,n.style.alignItems=i.align_items}),l.addEventListener("verse",function(t){const n=JSON.parse(t.data);console.log("verse is",n.data),e.post("/searchbibleverse",n,e=>{if(e.ok){let t="",n="";const i=e.data;i.length>1&&(t="\n\n");const l=i.length,r=Object.keys(i[0]).length;for(let e=0;e<r;e++){let o="";for(let n=0;n<l;n++)o+=i[n][Object.keys(i[n])[e]]+t;for(let t=0;t<l;t++){n=Object.keys(i[t])[e]}}o.textContent=verse,s.textContent=n}},e=>{console.error("Error getting verse",e)},!0)}),l.addEventListener("media",function(e){}),l.addEventListener("hidelyrics",function(e){o.show=!1}),l.addEventListener("blackscreen",function(e){o.show=!1,i.innerHTML="",s.show=!1}),l.addEventListener("showdesktop",function(e){}),l.addEventListener("showlyrics",function(e){o.show=!0,s.show=!0}),l.addEventListener("removebackground",function(e){i.innerHTML=""}),l.addEventListener("title",function(e){const t=JSON.parse(e.data);s.textContent=t.data.replaceAll('"',"")}),l.addEventListener("changebackground",function(t){let n=JSON.parse(t.data).data.replaceAll('"',"");if("link"===n)e.get("/getlink",e=>{e.ok?(console.log(e.link),r(e.link)):console.log("Failed to get link")},e=>{console.error("Error get bg link",e)},!0);else{r("uploaded/"+n)}}),l.addEventListener("connected",function(e){const t=JSON.parse(e.data);res=t.data.replaceAll('"',""),"true"===res&&(s.textContent="info")}),l.addEventListener("apmode",function(e){const t=JSON.parse(e.data).data.replaceAll('"',"");s.textContent=t})});
>>>>>>> ktor
